# 초기세팅

1. EC2부터 새로운 개발 서버 생성해서

2. 로드밸런스랑 기타 등등 다 연결하고 서버 다 띄운다음에 파이프라인까지?

3. EC2 생성할 때 AutoScailng + 시작 템플릿 구성

4. RDS 생성

5. 보안 그룹 생성

7. 서브넷 생성

6. 로드 밸런스 생성

- 리스너 규칙 추가 - 80일때 리다이렉션 + 호스트

- 443일 때 해당 호스트로 연결 

- 대상 그룹 설정할 때 대상 유형 설정하는 부분이 있었는데, ALB일 경우.. IP로 해야하는 것 같은데 인스턴스로 설정해버렸다.

- 이 부분은 처음 설정할 때 외에는 변경이 되지 않으므로 삭제했다 다시해야함

- 로드밸런스에 리스너로 등록된 대상 그룹을 삭제하고 재설정

- 인스턴스 ID로 대상을 등록하는 경우 Auto Scaling 그룹에 로드 밸런서를 사용할 수 있습니다.

- Auto Scaling 그룹에 대상 그룹을 연결하면 Auto Scaling은 대상을 시작할 때 대상 그룹에 해당 대상을 등록합니다.

- 자세한 내용은 Amazon EC2 Auto Scaling 사용 설명서에서 로드 밸런서를 Auto Scaling 그룹에 연결을 참조하세요.

7. route53에 호스팅 영역 레코드 생성
 - 값 - 별칭 - 로드 밸런스 - 새로 만든 로드밸런스

 8. CodePipeline 설정

 - 프로젝트 빌드 생성


 10. ECR 생성

 - 푸시 명령 보기로 해당 리포지토리에 있는 도커파일을 이미지 띄워서 aws로 푸쉬한다.
 

 9. 프로젝트 빌드

 - ECS 클러스트 생성

 - 클러스트 내 작업 정의 (Fargate)

 - taskdef로 새로 설정할 내용이면 대충 설정.. 하더라도 작업정의에서 컨테이너랑 이미지이름 포트명은 해당 ECR에 맞게 설정해야한다.

 - 클러스트 내 서비스 생성 -> 배포

 - 어플리케이션 생성

 - 배포그룹 생성

 - 환경변수 설정 (AWS Account ID, IMAGE REPO NAME, IMAGE TAG NAME ..)



# 삭제 해야할 것

2. 로드밸런스, 대상 그룹

3. 서브넷

4. RDS

- 인스턴스를 delete해야 클러스트 삭제 가능 Aurora

5. CodeBuild

6. 프로젝트 빌드에서 어플리케이션 삭제 배포그룹 삭제

6. CodePipeLine

8. ECR

- 리포지토리 삭제 (이미지도 같이 삭제)

7. ECS

- 서비스 삭제 (안하고 클러스트에서 바로 삭제해도 됨 클러스트 삭제는 현재 20210624 이전 버전에서만 지원함)

- 작업 정의는 해당 작업 정의 누르고 생성된 TASK들 셀렉트한 다음에 등록취소 했을 때 하나도 없으면 작업정의가 사라짐

10. Route53 해당 도메인 레코드 삭제

# ECR, ECS로 구성하기 때문에 인스턴스는 생성할 필요 없다.
