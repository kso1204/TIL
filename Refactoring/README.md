# 리팩토링

1. 리팩터링: 첫 번째 예시

- 프로그램이 새로운 기능을 추가하기에 편한 구조가 아니라면, 먼저 기능을 추가하기 쉬운 형태로 리팩터링하고 나서 원하는 기능을 추가한다.
- 리팩터링의 첫 단계는 리팩터링할 코드 영역을 꼼꼼하게 검사해줄 테스트 코드들 부터 마련해야 한다.
- 리팩터링하기 전에 제대로 된 테스트부터 마련한다. 테스트는 반드시 자가진단하도록 만든다.
- 리팩터링은 프로그램 수정을 작은 단계로 나눠 진행한다. 그래서 중간에 실수하더라도 버그를 쉽게 찾을 수 있다.
- 리팩터링의 저자는 함수의 반환 값에 항상 result라는 이름을 썼다. 그러면 그 변수의 역할을 쉽게 알 수 있다고..
- 함수를 만들고 그 함수를 인라인해서 사용한다?
- P48
- volumeCredits 변수를 제거하는 작업의 단계
- 반복문 쪼개기로 변수 값을 누적시키는 부분을 분리한다.
- 문장 슬라이드하기로 변수 초기화 문장을 변수 값 누적 코드 바로 앞으로 옮긴다
- 함수 추출하기로 적립 포인트 계산 부분을 별도 함수로 추출한다.
- 변수 인라인하기로 volumeCredits 변수를 제거한다.
- 여기서 궁금한건? totalVolumeCredits()에 invoice를 넣어주지 않아도 되는가..?

```

let volumeCredits = 0;

for (let perf of invoice.perfomances) {
    volumeCredits += volumeCreditsFor(perf);
}

->

function totalVolumeCredits()
{
    let volumeCredits = 0;

    for (let perf of invoice.perfomances) {
        volumeCredits += volumeCreditsFor(perf);
    }

    return volumeCredits;
}

이게 돼?

```

- 복잡하게 얽힌 덩어리를 잘게 쪼개면서 골격을 개선하고 단계를 쪼갠다.
- 함수 추출하기
- 변수 인라인하기
- 함수 옮기기
- 조건부 로직을 다형성으로 바꾸기


2. 리팩터링 원칙

- 90%의 시간은 낭비
- 성능에 대한 흥미로운 사실은, 대부분 프로그램은 전체 코드 중 극히 일부에서 대부분의 시간을 소비한다는 것

3. 코드에서 나는 악취

4. 테스트 구축하기

5. 리팩터링 카탈로그 보는법

6. 기본적인 리팩터링

7. 캡슐화

8. 기능 이동

9. 데이터 조직화

10. 조건부 로직 간소화

11. API 리팩터링

12. 상속 다루기

